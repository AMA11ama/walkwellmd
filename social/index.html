<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WalkWellMD — Links & Rehab Protocols</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .wm::before{
      content:"WalkWellMD";
      position:fixed; inset:0; display:block; pointer-events:none;
      font-size:10rem; font-weight:700; color:#0f766e22;
      transform:rotate(-22deg);
      left:50%; top:50%; translate:-50% -50%;
      letter-spacing:.1em; white-space:nowrap;
    }
    .glass{backdrop-filter:saturate(140%) blur(8px);}
  </style>
</head>
<body class="bg-slate-50 min-h-screen text-slate-900">
  <div class="fixed inset-0 flex items-center justify-center p-4">
    <div class="glass bg-white/85 shadow-2xl rounded-3xl w-full max-w-xl border border-slate-200">
      <!-- Header -->
      <div class="px-6 pt-6 pb-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <img src="/assets/walkwellmd-logo.png" alt="WalkWellMD Logo" class="h-12 w-12 rounded-2xl" />
          <div>
            <h1 class="text-lg font-semibold leading-tight">Dr. Ali Alhaddad · د. علي الحداد</h1>
            <p class="text-xs text-slate-500 -mt-0.5">Links • Post‑Op & Rehab Protocols</p>
          </div>
        </div>
        <a href="tel:+966127444444" class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-teal-600 text-white text-sm hover:bg-teal-700 transition" aria-label="Call booking 0127444444">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24 11.36 11.36 0 003.56.57 1 1 0 011 1v3.61a1 1 0 01-1 1A17 17 0 013 5a1 1 0 011-1h3.61a1 1 0 011 1 11.36 11.36 0 00.57 3.56 1 1 0 01-.24 1.01l-2.32 2.22z"/></svg>
          Book | للحجز
        </a>
      </div>

      <!-- Tabs -->
      <div class="px-6">
        <div class="bg-slate-100 rounded-2xl p-1 grid grid-cols-2 gap-1">
          <button id="tabSocial" class="tab active px-3 py-2 rounded-xl text-sm font-medium text-slate-700 bg-white shadow">Social</button>
          <button id="tabProtocols" class="tab px-3 py-2 rounded-xl text-sm font-medium text-slate-600 hover:bg-white/70">Protocols</button>
        </div>
      </div>

      <!-- Panels -->
      <div class="p-6 space-y-6">
        <!-- Social panel -->
        <section id="panelSocial" class="space-y-3">
          <a href="https://www.snapchat.com/add/walkwellmd" class="block w-full py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between">
            <span class="flex items-center gap-2 font-medium"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/snapchat.svg" class="h-4 w-4"/> Snapchat</span>
            <span class="text-xs text-slate-500">@walkwellmd</span>
          </a>
          <a href="https://www.instagram.com/walkwellmd" class="block w-full py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between">
            <span class="flex items-center gap-2 font-medium"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" class="h-4 w-4"/> Instagram</span>
            <span class="text-xs text-slate-500">@walkwellmd</span>
          </a>
          <a href="https://x.com/walkwellmd" class="block w-full py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between">
            <span class="flex items-center gap-2 font-medium"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg" class="h-4 w-4"/> X (Twitter)</span>
            <span class="text-xs text-slate-500">@walkwellmd</span>
          </a>
          <a href="https://www.tiktok.com/@walkwellmd8" class="block w-full py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between">
            <span class="flex items-center gap-2 font-medium"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/tiktok.svg" class="h-4 w-4"/> TikTok</span>
            <span class="text-xs text-slate-500">@walkwellmd8</span>
          </a>
          <a href="https://wa.me/966599124348" class="block w-full py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between">
            <span class="flex items-center gap-2 font-medium"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" class="h-4 w-4"/> WhatsApp</span>
            <span class="text-xs text-slate-500">Clinic</span>
          </a>
        </section>

        <!-- Protocols panel -->
        <section id="panelProtocols" class="hidden space-y-4">
          <div class="flex items-center gap-2">
            <input id="searchBox" type="search" placeholder="Search | بحث" class="flex-1 px-4 py-2 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-teal-500"/>
            <button id="langToggle" class="px-3 py-2 rounded-xl border border-slate-200 text-sm">EN/العربية</button>
          </div>
          <div id="protocolList" class="grid gap-2"></div>
          <dialog id="previewDlg" class="backdrop:bg-black/40 rounded-2xl p-0 w-[min(100%,850px)]">
            <div class="wm relative bg-white rounded-2xl overflow-hidden">
              <div class="flex items-center justify-between p-4 border-b">
                <h3 id="previewTitle" class="font-semibold text-lg">Preview</h3>
                <button id="closePreview" class="px-2 py-1 rounded-lg border text-sm">Close</button>
              </div>
              <div id="previewBody" class="h-[70vh]"></div>
            </div>
          </dialog>
        </section>
      </div>

      <!-- Footer -->
      <div class="px-6 pb-6 pt-2 text-xs text-slate-400">© <span id="y"></span> WalkWellMD — Dr. Ali Alhaddad</div>
    </div>
  </div>

  <script>
    const tabSocial = document.getElementById('tabSocial');
    const tabProtocols = document.getElementById('tabProtocols');
    const panelSocial = document.getElementById('panelSocial');
    const panelProtocols = document.getElementById('panelProtocols');

    function setTab(tab){
      const active = tab === 'protocols' ? tabProtocols : tabSocial;
      const inactive = tab === 'protocols' ? tabSocial : tabProtocols;
      active.classList.add('bg-white','shadow','text-slate-700');
      inactive.classList.remove('bg-white','shadow','text-slate-700');
      inactive.classList.add('text-slate-600');
      panelSocial.classList.toggle('hidden', tab === 'protocols');
      panelProtocols.classList.toggle('hidden', tab !== 'protocols');
      const url = new URL(window.location);
      url.searchParams.set('tab', tab);
      history.replaceState(null, '', url);
    }

    tabSocial.addEventListener('click',()=>setTab('social'));
    tabProtocols.addEventListener('click',()=>setTab('protocols'));

    const initTab = new URLSearchParams(location.search).get('tab') || 'social';
    setTab(initTab);

    const listEl = document.getElementById('protocolList');
    const searchBox = document.getElementById('searchBox');
    const langToggle = document.getElementById('langToggle');
    let lang = 'en';
    langToggle.addEventListener('click',()=>{ lang = lang==='en'?'ar':'en'; render(items); });

    let items = [];
    async function loadIndex(){
      try{
        const res = await fetch('/protocols/index.json', {cache:'no-store'});
        if(!res.ok) throw new Error('index.json not found');
        items = await res.json();
      }catch(err){
        console.warn('Using fallback demo items');
        items = [];
      }
      render(items);
    }

    function render(data){
      const q = (searchBox.value||'').toLowerCase();
      listEl.innerHTML = '';
      data.filter(it=> !q ||
        (it.title_en && it.title_en.toLowerCase().includes(q)) ||
        (it.title_ar && it.title_ar.includes(q)) ||
        (it.tags||[]).some(t=>t.toLowerCase().includes(q))
      ).forEach(it=>{
        const isAR = lang==='ar' && (it.lang==='ar' || it.lang==='bi');
        const title = isAR ? (it.title_ar||it.title_en) : (it.title_en||it.title_ar);
        const url = isAR ? (it.url_ar||it.url) : (it.url||it.url_ar);
        const row = document.createElement('button');
        row.className = 'w-full text-left py-3 px-4 rounded-2xl border border-slate-200 hover:border-teal-500 hover:shadow flex items-center justify-between';
        row.innerHTML = `<span class="font-medium ${isAR?'text-right w-full':''}" ${isAR?'dir="rtl"':''}>${title}</span><span class="text-xs text-slate-500">${it.type.toUpperCase()}</span>`;
        row.addEventListener('click',()=>openPreview(title,url,it.type));
        listEl.appendChild(row);
      });
    }

    function openPreview(title,url,type){
      const dlg = document.getElementById('previewDlg');
      document.getElementById('previewTitle').textContent = title;
      const body = document.getElementById('previewBody');
      body.innerHTML = '';
      const iframe = document.createElement('iframe');
      iframe.src = url;
      iframe.className = 'w-full h-full';
      body.appendChild(iframe);
      dlg.showModal();
    }

    document.getElementById('closePreview').addEventListener('click',()=>{
      document.getElementById('previewDlg').close();
    });
    searchBox.addEventListener('input',()=>render(items));
    loadIndex();
    document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>
</html>
